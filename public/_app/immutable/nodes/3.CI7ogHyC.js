import{d as H,a as E,t as M}from"../chunks/Bu-22Koh.js";import{R,V as ze,K as Ke,b as c,a as Xe,W as Ge,X as Ce,Y as De,Z as ie,T as P,aj as Qe,_ as Re,N as Me,$ as We,an as qe,w as Ze,m as Je,n as Te,at as ue,r as Ae,au as ea,av as aa,aw as ra,am as ta,ax as sa,Q as na,ay as oa,az as la,ah as ia,aA as ua,aB as ca,aC as da,u as Fe,aq as $e,ap as Le,a4 as $,z as ge,B as A,D as O,C as N,E as X,A as he,c as S,a5 as L,x as Ne}from"../chunks/Dht8psup.js";import{a as va,l as me,d as Be,s as se}from"../chunks/Db6IqV0G.js";import{i as z,s as ye,a as ke}from"../chunks/CQxybIOy.js";import{i as fa,p as I}from"../chunks/BlrLVMO9.js";import{s as _a,a as ga,t as Ie}from"../chunks/KUU7z-36.js";import{c as be,d as ee,e as ae,f as He,u as Ve,g as ha,h as ce,i as ma,j as ya}from"../chunks/ZdK32mGs.js";import{p as fe}from"../chunks/C6VAIcd6.js";function re(e,a){return a}function ka(e,a,r,s){for(var t=[],o=a.length,u=0;u<o;u++)ra(a[u].e,t,!0);var d=o>0&&t.length===0&&r!==null;if(d){var g=r.parentNode;ta(g),g.append(r),s.clear(),B(e,a[0].prev,a[o-1].next)}sa(t,()=>{for(var m=0;m<o;m++){var n=a[m];d||(s.delete(n.k),B(e,n.prev,n.next)),na(n.e,!d)}})}function te(e,a,r,s,t,o=null){var u=e,d={flags:a,items:new Map,first:null};R&&ze();var g=null,m=!1,n=Xe(()=>{var f=r();return Ze(f)?f:f==null?[]:qe(f)});Ke(()=>{var f=c(n),v=f.length;if(m&&v===0)return;m=v===0;let b=!1;if(R){var h=u.data===Ge;h!==(v===0)&&(u=Ce(),De(u),ie(!1),b=!0)}if(R){for(var U=null,y,l=0;l<v;l++){if(P.nodeType===8&&P.data===Qe){u=P,b=!0,ie(!1);break}var i=f[l],_=s(i,l);y=Ye(P,d,U,null,i,_,l,t,a,r),d.items.set(_,y),U=y}v>0&&De(Ce())}R||ba(f,d,u,t,a,s,r),o!==null&&(v===0?g?Re(g):g=Me(()=>o(u)):g!==null&&We(g,()=>{g=null})),b&&ie(!0),c(n)}),R&&(u=P)}function ba(e,a,r,s,t,o,u){var d=e.length,g=a.items,m=a.first,n=m,f,v=null,b=[],h=[],U,y,l,i;for(i=0;i<d;i+=1){if(U=e[i],y=o(U,i),l=g.get(y),l===void 0){var _=n?n.e.nodes_start:r;v=Ye(_,a,v,v===null?a.first:v.next,U,y,i,s,t,u),g.set(y,v),b=[],h=[],n=v.next;continue}if(wa(l,U,i),l.e.f&ue&&Re(l.e),l!==n){if(f!==void 0&&f.has(l)){if(b.length<h.length){var k=h[0],w;v=k.prev;var D=b[0],T=b[b.length-1];for(w=0;w<b.length;w+=1)Se(b[w],k,r);for(w=0;w<h.length;w+=1)f.delete(h[w]);B(a,D.prev,T.next),B(a,v,D),B(a,T,k),n=k,v=T,i-=1,b=[],h=[]}else f.delete(l),Se(l,n,r),B(a,l.prev,l.next),B(a,l,v===null?a.first:v.next),B(a,v,l),v=l;continue}for(b=[],h=[];n!==null&&n.k!==y;)n.e.f&ue||(f??(f=new Set)).add(n),h.push(n),n=n.next;if(n===null)continue;l=n}b.push(l),v=l,n=l.next}if(n!==null||f!==void 0){for(var x=f===void 0?[]:qe(f);n!==null;)n.e.f&ue||x.push(n),n=n.next;var C=x.length;if(C>0){var p=null;ka(a,x,p,g)}}Ae.first=a.first&&a.first.e,Ae.last=v&&v.e}function wa(e,a,r,s){aa(e.v,a),e.i=r}function Ye(e,a,r,s,t,o,u,d,g,m){var n=(g&oa)!==0,f=(g&la)===0,v=n?f?Je(t):Te(t):t,b=g&ea?Te(u):u,h={i:b,v,k:o,a:null,e:null,prev:r,next:s};try{return h.e=Me(()=>d(e,v,b,m),R),h.e.prev=r&&r.e,h.e.next=s&&s.e,r===null?a.first=h:(r.next=h,r.e.next=h.e),s!==null&&(s.prev=h,s.e.prev=h.e),h}finally{}}function Se(e,a,r){for(var s=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,o=e.e.nodes_start;o!==s;){var u=ia(o);t.before(o),o=u}}function B(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function _e(e){if(R){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var s=e.value;Ue(e,"value",null),e.value=s}if(e.hasAttribute("checked")){var t=e.checked;Ue(e,"checked",null),e.checked=t}}};e.__on_r=r,ua(r),va()}}function Ue(e,a,r,s){var t=e.__attributes??(e.__attributes={});R&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="style"&&"__styles"in e&&(e.__styles={}),a==="loading"&&(e[ca]=r),e.removeAttribute(a))}function Oe(e,a,r=a){var s=da();me(e,"input",t=>{var o=t?e.defaultValue:e.value;if(o=de(e)?ve(o):o,r(o),s&&o!==(o=a())){var u=e.selectionStart,d=e.selectionEnd;e.value=o??"",d!==null&&(e.selectionStart=u,e.selectionEnd=Math.min(d,e.value.length))}}),(R&&e.defaultValue!==e.value||Fe(a)==null&&e.value)&&r(de(e)?ve(e.value):e.value),$e(()=>{var t=a();de(e)&&t===ve(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function xa(e,a,r=a){me(e,"change",s=>{var t=s?e.defaultChecked:e.checked;r(t)}),(R&&e.defaultChecked!==e.checked||Fe(a)==null)&&r(e.checked),$e(()=>{var s=a();e.checked=!!s})}function de(e){var a=e.type;return a==="number"||a==="range"}function ve(e){return e===""?null:+e}function je(e,a,r){if(e.multiple)return Ca(e,a);for(var s of e.options){var t=K(s);if(fa(t,a)){s.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function pa(e,a){Le(()=>{var r=new MutationObserver(()=>{var s=e.__value;je(e,s)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function Ea(e,a,r=a){var s=!0;me(e,"change",t=>{var o=t?"[selected]":":checked",u;if(e.multiple)u=[].map.call(e.querySelectorAll(o),K);else{var d=e.querySelector(o)??e.querySelector("option:not([disabled])");u=d&&K(d)}r(u)}),Le(()=>{var t=a();if(je(e,t,s),s&&t===void 0){var o=e.querySelector(":checked");o!==null&&(t=K(o),r(t))}e.__value=t,s=!1}),pa(e)}function Ca(e,a){for(var r of e.options)r.selected=~a.indexOf(K(r))}function K(e){return"__value"in e?e.__value:e.value}var Da=M("<p>You must be loged in to access this page!!</p>");function Ta(e,a){const[r,s]=ye(),t=()=>ke(be,"$currentUser",r);var o=H(),u=$(o);{var d=m=>{var n=H(),f=$(n);_a(f,()=>a.children),E(m,n)},g=m=>{var n=Da();E(m,n)};z(u,m=>{t()?m(d):m(g,!1)})}E(e,o),s()}var Aa=(e,a)=>a.handleStatusChange(a.id,a.key),Na=M('<button><input type="checkbox"> <span class="mx-2"> </span></button>');function Ia(e,a){ge(a,!0);let r=fe(a,"value",7);var s=Na();ga(s,"my-4 flex w-full flex-row items-center justify-start rounded-2xl border-[1px] border-black bg-white p-3 shadow-md shadow-black transition duration-300 ease-in hover:shadow-2xl"),s.__click=[Aa,a];var t=A(s);_e(t);var o=O(t,2),u=A(o,!0);N(o),N(s),X(()=>se(u,r().task)),xa(t,()=>r().status,d=>r().status=d),E(e,s),he()}Be(["click"]);var Sa=(e,a)=>S(a,"category"),Ua=(e,a)=>S(a,"task"),Oa=(e,a)=>a(),Ra=M('<input type="text" name="task" class="input w-full md:w-1/3" placeholder="add new category"> <button class="btn-add m!w-full md:!w-1/4">Add Category</button>',1),Ma=M("<option> </option>"),qa=M('<select class="input w-full md:w-1/4"><option disabled selected>select your category</option><!></select> <input type="text" name="task" class="input w-full md:w-1/3" placeholder="start tracking..."> <button class="btn-add m!w-full md:!w-1/4">Add Task</button>',1),Fa=M('<div class="m-2 flex flex-col items-center justify-evenly p-2 md:m-4 md:p-4"><div class="mb-4 flex w-full flex-col justify-around gap-2 md:flex-row"><button class="btn-switch-2">Add New Category</button> <button class="btn-switch-2">Add Tasks</button></div> <hr class="w-full"> <div class="mt-4 flex w-full flex-col justify-evenly gap-3 md:flex-row"><!></div></div>');function $a(e,a){ge(a,!0);const[r,s]=ye(),t=()=>ke(be,"$currentUser",r);let o=fe(a,"category",15),u=fe(a,"taskName",15),d=L("category"),g=L("");async function m(){var i;if((i=t())!=null&&i.uid&&c(g))try{const _=ee(ae,"todos",t().uid);a.userCategory.length==0?await He(_,{category:[c(g)]},{merge:!0}):a.userCategory.includes(o())||await Ve(_,{category:ha(c(g))}),a.loadDocs()}catch(_){throw new Error("Unable to add record to db: ",_.stack)}else console.error("No user is logged in.")}var n=Fa(),f=A(n),v=A(f);v.__click=[Sa,d];var b=O(v,2);b.__click=[Ua,d],N(f);var h=O(f,4),U=A(h);{var y=i=>{var _=Ra(),k=$(_);_e(k);var w=O(k,2);w.__click=[Oa,m],Oe(k,()=>c(g),D=>S(g,D)),E(i,_)},l=i=>{var _=qa(),k=$(_),w=A(k);w.value=((w.__value="")==null,"");var D=O(w);te(D,17,()=>a.userCategory,re,(C,p)=>{var q=Ma(),F={},V=A(q,!0);N(q),X(()=>{F!==(F=c(p))&&(q.value=(q.__value=c(p))==null?"":c(p)),se(V,c(p))}),E(C,q)}),N(k);var T=O(k,2);_e(T);var x=O(T,2);x.__click=function(...C){var p;(p=a.addTodo)==null||p.apply(this,C)},Ea(k,o),Oe(T,u),E(i,_)};z(U,i=>{c(d)=="category"?i(y):i(l,!1)})}N(h),N(n),X(()=>{Ie(v,"active",c(d)==="category"),Ie(b,"active",c(d)==="task")}),E(e,n),he(),s()}Be(["click"]);var La=M('<div class="group rounded-3xl bg-[#D6E6F2] p-4 transition duration-300 ease-in hover:bg-[#769FCD]"><div class="category-title w-full bg-[#769FCD] transition duration-300 ease-out group-hover:bg-[#D6E6F2]"> </div> <!></div>'),Ba=M('<div class="group rounded-3xl bg-[#D6E6F2] p-4 transition duration-300 ease-in hover:bg-[#769FCD]"><div class="category-title w-full bg-[#769FCD] transition duration-300 ease-out group-hover:bg-[#D6E6F2]"> </div></div>'),Ha=M('<p class="text-2xl">ONE STEP AT A TIME</p> <!> <div class="m-4 grid grid-cols-1 gap-4 md:grid-cols-3"><!></div>',1),Va=M("<div><!></div>");function Wa(e,a){ge(a,!0);const[r,s]=ye(),t=()=>ke(be,"$currentUser",r);let o=L(""),u=L(I(Date.now())),d=L(""),g=L(I([])),m=L(I({})),n=L(I([]));Ne(()=>{f()}),Ne(()=>{console.log("category: ",c(o))});async function f(){var y;if((y=t())!=null&&y.uid){const l=ee(ae,"todos",t().uid),i=await ce(l);if(!i.exists()){S(n,I([])),S(m,I({}));return}const _=i.data();if(S(m,I((_==null?void 0:_.tasks)||{})),S(n,I((_==null?void 0:_.category)||[])),!i.exists())throw new Error("Data does not exists!")}else console.error("No user is logged in.")}async function v(){var y,l;if((y=t())!=null&&y.uid&&c(o)&&c(u))try{const i=ee(ae,"todos",t().uid),_={task:c(d),status:!1,createdAt:Date.now()},k=await ce(i);if(k.exists()){const w=((l=k.data().tasks)==null?void 0:l[c(o)])||{};if(Object.values(w).some(T=>T.task===c(d)))return}await He(i,{tasks:{[`${c(o)}`]:{[`${c(u)}`]:_}},"metadata.taskCount":ma(1)},{merge:!0}),S(d,""),S(u,I(Date.now())),await f()}catch(i){throw new Error("Unable to add record to db: ",i.stack)}else console.error("Missing required fields: user ID, category or taskID")}async function b(y,l){var i,_,k,w;if((i=t())!=null&&i.uid&&l&&y)try{const D=ee(ae,"todos",t().uid),T=`tasks.${l}.${y}.status`,x=await ce(D);if(!x.exists()){console.warn("Todo document does not exist for user:",t().uid);return}const C=x.data(),p=(w=(k=(_=C==null?void 0:C.tasks)==null?void 0:_[l])==null?void 0:k[y])==null?void 0:w.status;typeof p!="boolean"&&console.warn("Task not found at path: ",T),await Ve(D,{[T]:!p,"metadata.lastUpdated":ya()}),await f()}catch(D){throw new Error("Unable to update record in db: ",D.stack)}else console.error("Missing required fields: user ID, category or taskID")}var h=Va(),U=A(h);Ta(U,{children:(y,l)=>{var i=Ha(),_=O($(i),2);$a(_,{loadDocs:f,get userCategory(){return c(n)},addTodo:v,get sortedCategories(){return c(g)},set sortedCategories(x){S(g,I(x))},get category(){return c(o)},set category(x){S(o,I(x))},get taskName(){return c(d)},set taskName(x){S(d,I(x))}});var k=O(_,2),w=A(k);{var D=x=>{var C=H(),p=$(C);te(p,17,()=>Object.entries(c(m)),re,(q,F,V,we)=>{let G=()=>c(F)[0],Y=()=>c(F)[1];var Q=La(),W=A(Q),j=A(W,!0);N(W);var Z=O(W,2);{var ne=oe=>{var xe=H(),Pe=$(xe);te(Pe,17,()=>Object.entries(Y()).sort(([pe,J],[Ee,le])=>Number(J.status)-Number(le.status)),re,(pe,J)=>{let Ee=()=>c(J)[0],le=()=>c(J)[1];Ia(pe,{get id(){return Ee()},get key(){return G()},get value(){return le()},handleStatusChange:b})}),E(oe,xe)};z(Z,oe=>{Y()&&Object.entries(Y()).length>0&&oe(ne)})}N(Q),X(()=>se(j,G())),E(q,Q)}),E(x,C)},T=x=>{var C=H(),p=$(C);{var q=F=>{var V=H(),we=$(V);te(we,17,()=>c(n),re,(G,Y,Q,W)=>{var j=Ba(),Z=A(j),ne=A(Z,!0);N(Z),N(j),X(()=>se(ne,c(Y))),E(G,j)}),E(F,V)};z(p,F=>{c(n).length>0&&F(q)},!0)}E(x,C)};z(w,x=>{Object.entries(c(m)).length>0?x(D):x(T,!1)})}N(k),E(y,i)}}),N(h),E(e,h),he(),s()}export{Wa as component};
