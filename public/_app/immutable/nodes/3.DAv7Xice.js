import{c as Y,a as E,t as R}from"../chunks/Di4JCIrF.js";import{v as S,W as Pe,m as Ke,h as c,K as Xe,X as ze,Y as Ce,Z as De,_ as ie,w as P,ai as Ge,$ as Oe,n as Me,a0 as We,am as Re,I as Ze,N as Je,A as Ne,at as ue,F as Te,au as Qe,av as ea,aw as aa,al as ra,ax as ta,q as sa,ay as na,az as oa,ag as la,aA as ia,aB as ua,aC as ca,g as qe,ap as Fe,ao as $e,f as $,p as ge,c as T,s as M,r as A,t as te,a as he,C as O,ar as L,d as Ae}from"../chunks/9MDsvuXK.js";import{a as da,l as me,d as Le,s as se}from"../chunks/DM05Ajvg.js";import{i as K,s as ye,a as ke}from"../chunks/BlC_e75m.js";import{i as va,p as fe,a as I}from"../chunks/DK9sUCHr.js";import{s as fa}from"../chunks/DKIVDwcd.js";import{c as be,d as Q,e as ee,f as He,u as Ye,g as _a,h as ce,i as ga,j as ha}from"../chunks/B25tGlUA.js";function ae(e,a){return a}function ma(e,a,r,s){for(var t=[],o=a.length,u=0;u<o;u++)aa(a[u].e,t,!0);var v=o>0&&t.length===0&&r!==null;if(v){var g=r.parentNode;ra(g),g.append(r),s.clear(),H(e,a[0].prev,a[o-1].next)}ta(t,()=>{for(var m=0;m<o;m++){var n=a[m];v||(s.delete(n.k),H(e,n.prev,n.next)),sa(n.e,!v)}})}function re(e,a,r,s,t,o=null){var u=e,v={flags:a,items:new Map,first:null};S&&Pe();var g=null,m=!1,n=Xe(()=>{var f=r();return Ze(f)?f:f==null?[]:Re(f)});Ke(()=>{var f=c(n),d=f.length;if(m&&d===0)return;m=d===0;let b=!1;if(S){var h=u.data===ze;h!==(d===0)&&(u=Ce(),De(u),ie(!1),b=!0)}if(S){for(var U=null,y,l=0;l<d;l++){if(P.nodeType===8&&P.data===Ge){u=P,b=!0,ie(!1);break}var i=f[l],_=s(i,l);y=Be(P,v,U,null,i,_,l,t,a,r),v.items.set(_,y),U=y}d>0&&De(Ce())}S||ya(f,v,u,t,a,s,r),o!==null&&(d===0?g?Oe(g):g=Me(()=>o(u)):g!==null&&We(g,()=>{g=null})),b&&ie(!0),c(n)}),S&&(u=P)}function ya(e,a,r,s,t,o,u){var v=e.length,g=a.items,m=a.first,n=m,f,d=null,b=[],h=[],U,y,l,i;for(i=0;i<v;i+=1){if(U=e[i],y=o(U,i),l=g.get(y),l===void 0){var _=n?n.e.nodes_start:r;d=Be(_,a,d,d===null?a.first:d.next,U,y,i,s,t,u),g.set(y,d),b=[],h=[],n=d.next;continue}if(ka(l,U,i),l.e.f&ue&&Oe(l.e),l!==n){if(f!==void 0&&f.has(l)){if(b.length<h.length){var k=h[0],w;d=k.prev;var D=b[0],N=b[b.length-1];for(w=0;w<b.length;w+=1)Ie(b[w],k,r);for(w=0;w<h.length;w+=1)f.delete(h[w]);H(a,D.prev,N.next),H(a,d,D),H(a,N,k),n=k,d=N,i-=1,b=[],h=[]}else f.delete(l),Ie(l,n,r),H(a,l.prev,l.next),H(a,l,d===null?a.first:d.next),H(a,d,l),d=l;continue}for(b=[],h=[];n!==null&&n.k!==y;)n.e.f&ue||(f??(f=new Set)).add(n),h.push(n),n=n.next;if(n===null)continue;l=n}b.push(l),d=l,n=l.next}if(n!==null||f!==void 0){for(var x=f===void 0?[]:Re(f);n!==null;)n.e.f&ue||x.push(n),n=n.next;var C=x.length;if(C>0){var p=null;ma(a,x,p,g)}}Te.first=a.first&&a.first.e,Te.last=d&&d.e}function ka(e,a,r,s){ea(e.v,a),e.i=r}function Be(e,a,r,s,t,o,u,v,g,m){var n=(g&na)!==0,f=(g&oa)===0,d=n?f?Je(t):Ne(t):t,b=g&Qe?Ne(u):u,h={i:b,v:d,k:o,a:null,e:null,prev:r,next:s};try{return h.e=Me(()=>v(e,d,b,m),S),h.e.prev=r&&r.e,h.e.next=s&&s.e,r===null?a.first=h:(r.next=h,r.e.next=h.e),s!==null&&(s.prev=h,s.e.prev=h.e),h}finally{}}function Ie(e,a,r){for(var s=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,o=e.e.nodes_start;o!==s;){var u=la(o);t.before(o),o=u}}function H(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function _e(e){if(S){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var s=e.value;Se(e,"value",null),e.value=s}if(e.hasAttribute("checked")){var t=e.checked;Se(e,"checked",null),e.checked=t}}};e.__on_r=r,ia(r),da()}}function Se(e,a,r,s){var t=e.__attributes??(e.__attributes={});S&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="style"&&"__styles"in e&&(e.__styles={}),a==="loading"&&(e[ua]=r),e.removeAttribute(a))}function ba(e,a,r){var s=e.__className,t=wa(a);S&&e.className===t?e.__className=t:(s!==t||S&&e.className!==t)&&(e.className=t,e.__className=t)}function wa(e,a){return e+""}function Ue(e,a,r=a){var s=ca();me(e,"input",t=>{var o=t?e.defaultValue:e.value;if(o=de(e)?ve(o):o,r(o),s&&o!==(o=a())){var u=e.selectionStart,v=e.selectionEnd;e.value=o??"",v!==null&&(e.selectionStart=u,e.selectionEnd=Math.min(v,e.value.length))}}),(S&&e.defaultValue!==e.value||qe(a)==null&&e.value)&&r(de(e)?ve(e.value):e.value),Fe(()=>{var t=a();de(e)&&t===ve(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function xa(e,a,r=a){me(e,"change",s=>{var t=s?e.defaultChecked:e.checked;r(t)}),(S&&e.defaultChecked!==e.checked||qe(a)==null)&&r(e.checked),Fe(()=>{var s=a();e.checked=!!s})}function de(e){var a=e.type;return a==="number"||a==="range"}function ve(e){return e===""?null:+e}function Ve(e,a,r){if(e.multiple)return Ca(e,a);for(var s of e.options){var t=X(s);if(va(t,a)){s.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function pa(e,a){$e(()=>{var r=new MutationObserver(()=>{var s=e.__value;Ve(e,s)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function Ea(e,a,r=a){var s=!0;me(e,"change",t=>{var o=t?"[selected]":":checked",u;if(e.multiple)u=[].map.call(e.querySelectorAll(o),X);else{var v=e.querySelector(o)??e.querySelector("option:not([disabled])");u=v&&X(v)}r(u)}),$e(()=>{var t=a();if(Ve(e,t,s),s&&t===void 0){var o=e.querySelector(":checked");o!==null&&(t=X(o),r(t))}e.__value=t,s=!1}),pa(e)}function Ca(e,a){for(var r of e.options)r.selected=~a.indexOf(X(r))}function X(e){return"__value"in e?e.__value:e.value}var Da=R("<p>You must be loged in to access this page!!</p>");function Na(e,a){const[r,s]=ye(),t=()=>ke(be,"$currentUser",r);var o=Y(),u=$(o);{var v=m=>{var n=Y(),f=$(n);fa(f,()=>a.children),E(m,n)},g=m=>{var n=Da();E(m,n)};K(u,m=>{t()?m(v):m(g,!1)})}E(e,o),s()}var Ta=(e,a)=>a.handleStatusChange(a.id,a.key),Aa=R('<button><input type="checkbox"> <span class="mx-2"> </span></button>');function Ia(e,a){ge(a,!0);let r=fe(a,"value",7);var s=Aa();ba(s,"my-4 flex w-full flex-row items-center justify-start rounded-2xl border-[1px] border-black bg-white p-3 shadow-md shadow-black transition duration-300 ease-in hover:shadow-2xl"),s.__click=[Ta,a];var t=T(s);_e(t);var o=M(t,2),u=T(o,!0);A(o),A(s),te(()=>se(u,r().task)),xa(t,()=>r().status,v=>r().status=v),E(e,s),he()}Le(["click"]);var Sa=(e,a)=>O(a,"category"),Ua=(e,a)=>O(a,"task"),Oa=(e,a)=>a(),Ma=R('<input type="text" name="task" class="input w-full md:w-1/3" placeholder="add new category"> <button class="btn-add m!w-full md:!w-1/4">Add Category</button>',1),Ra=R("<option> </option>"),qa=R('<select class="input w-full md:w-1/4"><option disabled selected>select your category</option><!></select> <input type="text" name="task" class="input w-full md:w-1/3" placeholder="start tracking..."> <button class="btn-add m!w-full md:!w-1/4">Add Task</button>',1),Fa=R('<div class="m-2 flex flex-col items-center justify-evenly p-2 md:m-4 md:p-4"><div class="mb-4 flex w-full flex-col justify-around gap-2 md:flex-row"><button class="btn-switch-2">Add New Category</button> <button class="btn-switch-2">Add Tasks</button></div> <hr class="w-full"> <div class="mt-4 flex w-full flex-col justify-evenly gap-3 md:flex-row"><!></div></div>');function $a(e,a){ge(a,!0);const[r,s]=ye(),t=()=>ke(be,"$currentUser",r);let o=fe(a,"category",15),u=fe(a,"taskName",15),v=L("category"),g=L("");async function m(){var i;if((i=t())!=null&&i.uid&&c(g))try{const _=Q(ee,"todos",t().uid);a.userCategory.length==0?await He(_,{category:[c(g)]},{merge:!0}):a.userCategory.includes(o())||await Ye(_,{category:_a(c(g))}),a.loadDocs()}catch(_){throw new Error("Unable to add record to db: ",_.stack)}else console.error("No user is logged in.")}var n=Fa(),f=T(n),d=T(f);d.__click=[Sa,v];var b=M(d,2);b.__click=[Ua,v],A(f);var h=M(f,4),U=T(h);{var y=i=>{var _=Ma(),k=$(_);_e(k);var w=M(k,2);w.__click=[Oa,m],Ue(k,()=>c(g),D=>O(g,D)),E(i,_)},l=i=>{var _=qa(),k=$(_),w=T(k);w.value=((w.__value="")==null,"");var D=M(w);re(D,17,()=>a.userCategory,ae,(C,p)=>{var q=Ra(),F={},B=T(q,!0);A(q),te(()=>{F!==(F=c(p))&&(q.value=(q.__value=c(p))==null?"":c(p)),se(B,c(p))}),E(C,q)}),A(k);var N=M(k,2);_e(N);var x=M(N,2);x.__click=function(...C){var p;(p=a.addTodo)==null||p.apply(this,C)},Ea(k,o),Ue(N,u),E(i,_)};K(U,i=>{c(v)=="category"?i(y):i(l,!1)})}A(h),A(n),E(e,n),he(),s()}Le(["click"]);var La=R('<div class="group rounded-3xl bg-[#D6E6F2] p-4 transition duration-300 ease-in hover:bg-[#769FCD]"><div class="category-title w-full bg-[#769FCD] transition duration-300 ease-out group-hover:bg-[#D6E6F2]"> </div> <!></div>'),Ha=R('<div class="group rounded-3xl bg-[#D6E6F2] p-4 transition duration-300 ease-in hover:bg-[#769FCD]"><div class="category-title w-full bg-[#769FCD] transition duration-300 ease-out group-hover:bg-[#D6E6F2]"> </div></div>'),Ya=R('<p class="text-2xl">ONE STEP AT A TIME</p> <!> <div class="grid grid-cols-1 gap-4 md:grid-cols-3"><!></div>',1),Ba=R("<div><!></div>");function Wa(e,a){ge(a,!0);const[r,s]=ye(),t=()=>ke(be,"$currentUser",r);let o=L(""),u=L(I(Date.now())),v=L(""),g=L(I([])),m=L(I({})),n=L(I([]));Ae(()=>{f()}),Ae(()=>{console.log("category: ",c(o))});async function f(){var y;if((y=t())!=null&&y.uid){const l=Q(ee,"todos",t().uid),i=await ce(l);if(!i.exists()){O(n,I([])),O(m,I({}));return}const _=i.data();if(O(m,I((_==null?void 0:_.tasks)||{})),O(n,I((_==null?void 0:_.category)||[])),!i.exists())throw new Error("Data does not exists!")}else console.error("No user is logged in.")}async function d(){var y,l;if((y=t())!=null&&y.uid&&c(o)&&c(u))try{const i=Q(ee,"todos",t().uid),_={task:c(v),status:!1,createdAt:Date.now()},k=await ce(i);if(k.exists()){const w=((l=k.data().tasks)==null?void 0:l[c(o)])||{};if(Object.values(w).some(N=>N.task===c(v)))return}await He(i,{tasks:{[`${c(o)}`]:{[`${c(u)}`]:_}},"metadata.taskCount":ga(1)},{merge:!0}),O(u,I(Date.now())),await f()}catch(i){throw new Error("Unable to add record to db: ",i.stack)}else console.error("Missing required fields: user ID, category or taskID")}async function b(y,l){var i,_,k,w;if((i=t())!=null&&i.uid&&l&&y)try{const D=Q(ee,"todos",t().uid),N=`tasks.${l}.${y}.status`,x=await ce(D);if(!x.exists()){console.warn("Todo document does not exist for user:",t().uid);return}const C=x.data(),p=(w=(k=(_=C==null?void 0:C.tasks)==null?void 0:_[l])==null?void 0:k[y])==null?void 0:w.status;typeof p!="boolean"&&console.warn("Task not found at path: ",N),await Ye(D,{[N]:!p,"metadata.lastUpdated":ha()}),await f()}catch(D){throw new Error("Unable to update record in db: ",D.stack)}else console.error("Missing required fields: user ID, category or taskID")}var h=Ba(),U=T(h);Na(U,{children:(y,l)=>{var i=Ya(),_=M($(i),2);$a(_,{loadDocs:f,get userCategory(){return c(n)},addTodo:d,get sortedCategories(){return c(g)},set sortedCategories(x){O(g,I(x))},get category(){return c(o)},set category(x){O(o,I(x))},get taskName(){return c(v)},set taskName(x){O(v,I(x))}});var k=M(_,2),w=T(k);{var D=x=>{var C=Y(),p=$(C);re(p,17,()=>Object.entries(c(m)),ae,(q,F,B,we)=>{let z=()=>c(F)[0],V=()=>c(F)[1];var G=La(),W=T(G),j=T(W,!0);A(W);var Z=M(W,2);{var ne=oe=>{var xe=Y(),je=$(xe);re(je,17,()=>Object.entries(V()).sort(([pe,J],[Ee,le])=>Number(J.status)-Number(le.status)),ae,(pe,J)=>{let Ee=()=>c(J)[0],le=()=>c(J)[1];Ia(pe,{get id(){return Ee()},get key(){return z()},get value(){return le()},handleStatusChange:b})}),E(oe,xe)};K(Z,oe=>{V()&&Object.entries(V()).length>0&&oe(ne)})}A(G),te(()=>se(j,z())),E(q,G)}),E(x,C)},N=x=>{var C=Y(),p=$(C);{var q=F=>{var B=Y(),we=$(B);re(we,17,()=>c(n),ae,(z,V,G,W)=>{var j=Ha(),Z=T(j),ne=T(Z,!0);A(Z),A(j),te(()=>se(ne,c(V))),E(z,j)}),E(F,B)};K(p,F=>{c(n).length>0&&F(q)},!0)}E(x,C)};K(w,x=>{Object.entries(c(m)).length>0?x(D):x(N,!1)})}A(k),E(y,i)}}),A(h),E(e,h),he(),s()}export{Wa as component};
