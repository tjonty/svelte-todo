import{d as B,a as E,t as q}from"../chunks/B_oZFoJy.js";import{V as R,X as Xe,N as Ge,i as d,e as Ke,Y as Qe,Z as De,_ as Ae,$ as ce,W as j,ak as We,a0 as Re,Q as qe,a1 as Ze,ao as Fe,E as Je,m as ea,z as Ce,au as de,B as Ne,av as aa,aw as ta,ax as ra,an as sa,ay as na,T as oa,az as la,aA as ia,ai as ua,aB as ca,aC as da,aD as va,u as Pe,ar as $e,aq as He,f as F,p as me,c as C,s as O,r as N,t as G,a as ye,j as M,a6 as H,H as Ie,o as fa}from"../chunks/CaA2cR5q.js";import{a as _a,l as ke,d as Le,s as oe}from"../chunks/RVlpir22.js";import{i as z,s as we,a as pe}from"../chunks/BtHjZoZi.js";import{i as ga,p as U}from"../chunks/BFXrngcl.js";import{s as ha,a as ma,t as Se}from"../chunks/Dj9CoX24.js";import{c as be,e as ae,f as te,g as Be,u as Ve,h as ya,a as P,l as re,i as ve,j as ka,k as wa}from"../chunks/DUUvjixT.js";import{p as ge}from"../chunks/hXGGxj2V.js";function se(e,a){return a}function pa(e,a,t,s){for(var r=[],n=a.length,u=0;u<n;u++)ra(a[u].e,r,!0);var c=n>0&&r.length===0&&t!==null;if(c){var f=t.parentNode;sa(f),f.append(t),s.clear(),$(e,a[0].prev,a[n-1].next)}na(r,()=>{for(var g=0;g<n;g++){var o=a[g];c||(s.delete(o.k),$(e,o.prev,o.next)),oa(o.e,!c)}})}function ne(e,a,t,s,r,n=null){var u=e,c={flags:a,items:new Map,first:null};R&&Xe();var f=null,g=!1,o=Ke(()=>{var _=t();return Je(_)?_:_==null?[]:Fe(_)});Ge(()=>{var _=d(o),v=_.length;if(g&&v===0)return;g=v===0;let y=!1;if(R){var h=u.data===Qe;h!==(v===0)&&(u=De(),Ae(u),ce(!1),y=!0)}if(R){for(var w=null,p,l=0;l<v;l++){if(j.nodeType===8&&j.data===We){u=j,y=!0,ce(!1);break}var i=_[l],m=s(i,l);p=Ye(j,c,w,null,i,m,l,r,a,t),c.items.set(m,p),w=p}v>0&&Ae(De())}R||ba(_,c,u,r,a,s,t),n!==null&&(v===0?f?Re(f):f=qe(()=>n(u)):f!==null&&Ze(f,()=>{f=null})),y&&ce(!0),d(o)}),R&&(u=j)}function ba(e,a,t,s,r,n,u){var c=e.length,f=a.items,g=a.first,o=g,_,v=null,y=[],h=[],w,p,l,i;for(i=0;i<c;i+=1){if(w=e[i],p=n(w,i),l=f.get(p),l===void 0){var m=o?o.e.nodes_start:t;v=Ye(m,a,v,v===null?a.first:v.next,w,p,i,s,r,u),f.set(p,v),y=[],h=[],o=v.next;continue}if(xa(l,w,i),l.e.f&de&&Re(l.e),l!==o){if(_!==void 0&&_.has(l)){if(y.length<h.length){var x=h[0],k;v=x.prev;var D=y[0],b=y[y.length-1];for(k=0;k<y.length;k+=1)Ue(y[k],x,t);for(k=0;k<h.length;k+=1)_.delete(h[k]);$(a,D.prev,b.next),$(a,v,D),$(a,b,x),o=x,v=b,i-=1,y=[],h=[]}else _.delete(l),Ue(l,o,t),$(a,l.prev,l.next),$(a,l,v===null?a.first:v.next),$(a,v,l),v=l;continue}for(y=[],h=[];o!==null&&o.k!==p;)o.e.f&de||(_??(_=new Set)).add(o),h.push(o),o=o.next;if(o===null)continue;l=o}y.push(l),v=l,o=l.next}if(o!==null||_!==void 0){for(var T=_===void 0?[]:Fe(_);o!==null;)o.e.f&de||T.push(o),o=o.next;var I=T.length;if(I>0){var A=null;pa(a,T,A,f)}}Ne.first=a.first&&a.first.e,Ne.last=v&&v.e}function xa(e,a,t,s){ta(e.v,a),e.i=t}function Ye(e,a,t,s,r,n,u,c,f,g){var o=(f&la)!==0,_=(f&ia)===0,v=o?_?ea(r):Ce(r):r,y=f&aa?Ce(u):u,h={i:y,v,k:n,a:null,e:null,prev:t,next:s};try{return h.e=qe(()=>c(e,v,y,g),R),h.e.prev=t&&t.e,h.e.next=s&&s.e,t===null?a.first=h:(t.next=h,t.e.next=h.e),s!==null&&(s.prev=h,s.e.prev=h.e),h}finally{}}function Ue(e,a,t){for(var s=e.next?e.next.e.nodes_start:t,r=a?a.e.nodes_start:t,n=e.e.nodes_start;n!==s;){var u=ua(n);r.before(n),n=u}}function $(e,a,t){a===null?e.first=t:(a.next=t,a.e.next=t&&t.e),t!==null&&(t.prev=a,t.e.prev=a&&a.e)}function he(e){if(R){var a=!1,t=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var s=e.value;Me(e,"value",null),e.value=s}if(e.hasAttribute("checked")){var r=e.checked;Me(e,"checked",null),e.checked=r}}};e.__on_r=t,ca(t),_a()}}function Me(e,a,t,s){var r=e.__attributes??(e.__attributes={});R&&(r[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||r[a]!==(r[a]=t)&&(a==="style"&&"__styles"in e&&(e.__styles={}),a==="loading"&&(e[da]=t),e.removeAttribute(a))}function Oe(e,a,t=a){var s=va();ke(e,"input",r=>{var n=r?e.defaultValue:e.value;if(n=fe(e)?_e(n):n,t(n),s&&n!==(n=a())){var u=e.selectionStart,c=e.selectionEnd;e.value=n??"",c!==null&&(e.selectionStart=u,e.selectionEnd=Math.min(c,e.value.length))}}),(R&&e.defaultValue!==e.value||Pe(a)==null&&e.value)&&t(fe(e)?_e(e.value):e.value),$e(()=>{var r=a();fe(e)&&r===_e(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function Ea(e,a,t=a){ke(e,"change",s=>{var r=s?e.defaultChecked:e.checked;t(r)}),(R&&e.defaultChecked!==e.checked||Pe(a)==null)&&t(e.checked),$e(()=>{var s=a();e.checked=!!s})}function fe(e){var a=e.type;return a==="number"||a==="range"}function _e(e){return e===""?null:+e}function je(e,a,t){if(e.multiple)return Aa(e,a);for(var s of e.options){var r=X(s);if(ga(r,a)){s.selected=!0;return}}(!t||a!==void 0)&&(e.selectedIndex=-1)}function Ta(e,a){He(()=>{var t=new MutationObserver(()=>{var s=e.__value;je(e,s)});return t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function Da(e,a,t=a){var s=!0;ke(e,"change",r=>{var n=r?"[selected]":":checked",u;if(e.multiple)u=[].map.call(e.querySelectorAll(n),X);else{var c=e.querySelector(n)??e.querySelector("option:not([disabled])");u=c&&X(c)}t(u)}),He(()=>{var r=a();if(je(e,r,s),s&&r===void 0){var n=e.querySelector(":checked");n!==null&&(r=X(n),t(r))}e.__value=r,s=!1}),Ta(e)}function Aa(e,a){for(var t of e.options)t.selected=~a.indexOf(X(t))}function X(e){return"__value"in e?e.__value:e.value}var Ca=q("<p>You must be loged in to access this page!!</p>");function Na(e,a){const[t,s]=we(),r=()=>pe(be,"$currentUser",t);var n=B(),u=F(n);{var c=g=>{var o=B(),_=F(o);ha(_,()=>a.children),E(g,o)},f=g=>{var o=Ca();E(g,o)};z(u,g=>{r()?g(c):g(f,!1)})}E(e,n),s()}var Ia=(e,a)=>a.handleStatusChange(a.id,a.key),Sa=q('<button><input type="checkbox"> <span class="mx-2"> </span></button>');function Ua(e,a){me(a,!0);let t=ge(a,"value",7);var s=Sa();ma(s,"my-4 flex w-full flex-row items-center justify-start rounded-2xl border-[1px] border-black bg-white p-3 shadow-md shadow-black transition duration-300 ease-in hover:shadow-2xl"),s.__click=[Ia,a];var r=C(s);he(r);var n=O(r,2),u=C(n,!0);N(n),N(s),G(()=>oe(u,t().task)),Ea(r,()=>t().status,c=>t().status=c),E(e,s),ye()}Le(["click"]);var Ma=(e,a)=>M(a,"category"),Oa=(e,a)=>M(a,"task"),Ra=(e,a)=>a(),qa=q('<input type="text" name="task" class="input w-full md:w-1/3" placeholder="add new category"> <button class="btn-add m!w-full md:!w-1/4">Add Category</button>',1),Fa=q("<option> </option>"),Pa=q('<select class="input w-full md:w-1/4"><option disabled selected>select your category</option><!></select> <input type="text" name="task" class="input w-full md:w-1/3" placeholder="start tracking..."> <button class="btn-add m!w-full md:!w-1/4">Add Task</button>',1),$a=q('<div class="m-2 flex flex-col items-center justify-evenly p-2 md:m-4 md:p-4"><div class="mb-4 flex w-full flex-col justify-around gap-2 md:flex-row"><button class="btn-switch-2">Add New Category</button> <button class="btn-switch-2">Add Tasks</button></div> <hr class="w-full"> <div class="mt-4 flex w-full flex-col justify-evenly gap-3 md:flex-row"><!></div></div>');function Ha(e,a){me(a,!0);const[t,s]=we(),r=()=>pe(be,"$currentUser",t);let n=ge(a,"category",15),u=ge(a,"taskName",15),c=H("category"),f=H("");async function g(){var i;if((i=r())!=null&&i.uid&&d(f))try{const m=ae(te,"todos",r().uid);a.userCategory.length==0?await Be(m,{category:[d(f)]},{merge:!0}):a.userCategory.includes(n())||await Ve(m,{category:ya(d(f))}),a.loadDocs(),P&&re(P,"category_added",{page_title:"Todo Page",page_location:window.location.href,page_path:window.location.pathname})}catch(m){throw new Error("Unable to add record to db: ",m.stack)}else console.error("No user is logged in.")}var o=$a(),_=C(o),v=C(_);v.__click=[Ma,c];var y=O(v,2);y.__click=[Oa,c],N(_);var h=O(_,4),w=C(h);{var p=i=>{var m=qa(),x=F(m);he(x);var k=O(x,2);k.__click=[Ra,g],Oe(x,()=>d(f),D=>M(f,D)),E(i,m)},l=i=>{var m=Pa(),x=F(m),k=C(x);k.value=((k.__value="")==null,"");var D=O(k);ne(D,17,()=>a.userCategory,se,(I,A)=>{var S=Fa(),L={},K=C(S,!0);N(S),G(()=>{L!==(L=d(A))&&(S.value=(S.__value=d(A))==null?"":d(A)),oe(K,d(A))}),E(I,S)}),N(x);var b=O(x,2);he(b);var T=O(b,2);T.__click=function(...I){var A;(A=a.addTodo)==null||A.apply(this,I)},Da(x,n),Oe(b,u),E(i,m)};z(w,i=>{d(c)=="category"?i(p):i(l,!1)})}N(h),N(o),G(()=>{Se(v,"active",d(c)==="category"),Se(y,"active",d(c)==="task")}),E(e,o),ye(),s()}Le(["click"]);var La=q('<div class="group rounded-3xl bg-[#D6E6F2] p-4 transition duration-300 ease-in hover:bg-[#769FCD]"><div class="category-title w-full bg-[#769FCD] transition duration-300 ease-out group-hover:bg-[#D6E6F2]"> </div> <!></div>'),Ba=q('<div class="group rounded-3xl bg-[#D6E6F2] p-4 transition duration-300 ease-in hover:bg-[#769FCD]"><div class="category-title w-full bg-[#769FCD] transition duration-300 ease-out group-hover:bg-[#D6E6F2]"> </div></div>'),Va=q('<p class="text-2xl">ONE STEP AT A TIME</p> <!> <div class="m-4 grid grid-cols-1 gap-4 md:grid-cols-3"><!></div>',1),Ya=q("<div><!></div>");function Ja(e,a){me(a,!0);const[t,s]=we(),r=()=>pe(be,"$currentUser",t);let n=H(""),u=H(U(Date.now())),c=H("");U([]);let f=H(U({})),g=H(U([]));Ie(()=>{o()}),Ie(()=>{console.log("category: ",d(n))});async function o(){var w;if((w=r())!=null&&w.uid){const p=ae(te,"todos",r().uid),l=await ve(p);if(!l.exists()){M(g,U([])),M(f,U({}));return}const i=l.data();if(M(f,U((i==null?void 0:i.tasks)||{})),M(g,U((i==null?void 0:i.category)||[])),!l.exists())throw new Error("Data does not exists!")}else console.error("No user is logged in.")}async function _(){var w,p;if((w=r())!=null&&w.uid&&d(n)&&d(u))try{const l=ae(te,"todos",r().uid),i={task:d(c),status:!1,createdAt:Date.now()},m=await ve(l);if(m.exists()){const x=((p=m.data().tasks)==null?void 0:p[d(n)])||{};if(Object.values(x).some(D=>D.task===d(c)))return}await Be(l,{tasks:{[`${d(n)}`]:{[`${d(u)}`]:i}},"metadata.taskCount":ka(1)},{merge:!0}),M(c,""),M(u,U(Date.now())),await o(),P&&re(P,"task_added",{page_title:"Todo Page",page_location:window.location.href,page_path:window.location.pathname})}catch(l){throw new Error("Unable to add record to db: ",l.stack)}else console.error("Missing required fields: user ID, category or taskID")}async function v(w,p){var l,i,m,x;if((l=r())!=null&&l.uid&&p&&w)try{const k=ae(te,"todos",r().uid),D=`tasks.${p}.${w}.status`,b=await ve(k);if(!b.exists()){console.warn("Todo document does not exist for user:",r().uid);return}const T=b.data(),I=(x=(m=(i=T==null?void 0:T.tasks)==null?void 0:i[p])==null?void 0:m[w])==null?void 0:x.status;typeof I!="boolean"&&console.warn("Task not found at path: ",D),await Ve(k,{[D]:!I,"metadata.lastUpdated":wa()}),await o(),P&&re(P,"task_status_changed",{page_title:"Todo Page",page_location:window.location.href,page_path:window.location.pathname})}catch(k){throw new Error("Unable to update record in db: ",k.stack)}else console.error("Missing required fields: user ID, category or taskID")}fa(()=>{P&&re(P,"page_view",{page_title:"Todo Page",page_location:window.location.href,page_path:window.location.pathname})});var y=Ya(),h=C(y);Na(h,{children:(w,p)=>{var l=Va(),i=O(F(l),2);Ha(i,{loadDocs:o,get userCategory(){return d(g)},addTodo:_,get category(){return d(n)},set category(b){M(n,U(b))},get taskName(){return d(c)},set taskName(b){M(c,U(b))}});var m=O(i,2),x=C(m);{var k=b=>{var T=B(),I=F(T);ne(I,17,()=>Object.entries(d(f)),se,(A,S,L,K)=>{let Q=()=>d(S)[0],V=()=>d(S)[1];var W=La(),Z=C(W),Y=C(Z,!0);N(Z);var J=O(Z,2);{var le=ie=>{var xe=B(),ze=F(xe);ne(ze,17,()=>Object.entries(V()).sort(([Ee,ee],[Te,ue])=>Number(ee.status)-Number(ue.status)),se,(Ee,ee)=>{let Te=()=>d(ee)[0],ue=()=>d(ee)[1];Ua(Ee,{get id(){return Te()},get key(){return Q()},get value(){return ue()},handleStatusChange:v})}),E(ie,xe)};z(J,ie=>{V()&&Object.entries(V()).length>0&&ie(le)})}N(W),G(()=>oe(Y,Q())),E(A,W)}),E(b,T)},D=b=>{var T=B(),I=F(T);{var A=S=>{var L=B(),K=F(L);ne(K,17,()=>d(g),se,(Q,V,W,Z)=>{var Y=Ba(),J=C(Y),le=C(J,!0);N(J),N(Y),G(()=>oe(le,d(V))),E(Q,Y)}),E(S,L)};z(I,S=>{d(g).length>0&&S(A)},!0)}E(b,T)};z(x,b=>{Object.entries(d(f)).length>0?b(k):b(D,!1)})}N(m),E(w,l)}}),N(y),E(e,y),ye(),s()}export{Ja as component};
